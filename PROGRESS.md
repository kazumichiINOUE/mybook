# mdBook技術教材開発 進捗管理

## プロジェクト概要
- **プロジェクト名**: IRLab Essential Notes
- **目的**: 研究・教育の知見を蓄積するmdBookベース文書システム
- **主要コンテンツ**: ロボット制御実習手順書、mdBook活用技術、教育技術ノート
- **開発環境**: mdBook + Claude Code + GitHub Pages

## 作業履歴

### 2025-07-11 セッション
#### 完了した作業

**1. Neovimの日本語入力設定支援**
- Neovimでの折り返し行での視覚的移動方法をLuaで説明
- `gj`/`gk`を使った画面表示に合わせたカーソル移動設定

**2. nvim_cursor_jump.mdの改善**
- 発音記号の修正（`` \`\` ``の説明を「最後に編集した位置へ戻る」に訂正）
- 実用的なコマンドに厳選し，より使いやすいリファレンスに改良
- 細い矢印アイコン（`fa-long-arrow-right`）の導入

**3. アイコン管理の充実**
- Font Awesome 4アイコン一覧に細い矢印（左右）を追加
- `fa-long-arrow-right`，`fa-long-arrow-left`をコピペ用として整備

**4. Raspberry Pi日本語入力問題の記事作成**
- lxterminalでの母音のみ入力問題の解決方法を文書化
- fcitx5-mozcを使った3ステップ解決法の記録

**5. サイト構成の改善**
- SUMMARYの階層構造を整理（講義ノート，エディタ・ツール等）
- ディレクトリ構造の論理的整理（robot_basis/，teaching_advanced/）

**6. デザインとスタイリング**
- サイトタイトルの詩的調整（emダッシュ使用）
- Rustテーマをデフォルト設定
- 田園的で知的なサイトタイトルデザイン実装

**7. メタ情報システムの確立**
- 全記事への統一メタ情報フォーマット導入
- 位置依存から`.meta-info`クラスベースへの変更
- CSSによる右寄せスタイルの実装
- Markdown記法を保持した形式の確立

**8. 発音記号の正確性向上**
- irlabenの発音記号を `/ˈaɪl ˈraːbən/`（アイル・ラーベン）に修正
- README.mdへの発音表記追加

#### 技術的成果
- `.meta-info`クラスによる柔軟なメタ情報スタイリング
- 位置に依存しない確実なスタイル適用システム
- Markdownとの互換性を保った形式
- 階層化されたファイル構成と統一されたメタ情報フォーマット

### 2025-07-09 セッション1: ロボット制御基礎手順書の統合開発

#### 完了した作業

1. **手順書の構成改善** ✅
   - **目的**: 教育学部技術分野学生8名（2名×4グループ）向け実験手順書の最適化
   - **実施内容**:
     - 作業分担の見直し：並行作業から協力作業への変更
     - 実験内容の順序調整：モーター制御→超音波センサー統合→実機テスト
     - OLED関連作業を次週用別ファイル（oled_connector_250717.md）に分離
   - **効果**: 90分の実験時間に最適化された段階的学習構成

2. **モーター制御セクションの大幅強化** ✅
   - **独立二輪駆動制御の理論追加**:
     - 4つの組み合わせパターン（f,r / f,f / r,r / r,f）の体系化
     - 配線向きによる前進パターンの違いの説明
     - forward/reverse の定義明確化（CW/CCW、正転/逆転）
   - **実践的プログラム提供**:
     - パターン確認プログラム：4パターンを自動テストするプログラム
     - Hintプログラム：前進動作の雛形プログラム
     - 統合プログラムヒント：コメント形式での実装ガイド
   - **安全性強化**:
     - 拡張ボードスライドスイッチのON/OFF手順追加
     - スイッチ位置を示す画像（images/拡張ボード電源スイッチ.JPG）挿入
     - バッテリー接続手順の明記

3. **超音波センサー接続の詳細化** ✅
   - **端子役割の明確化**:
     - VCC（3.3V・赤線）、TRIG（GP0・黄線）、ECHO（GP1・白線）、GND（黒線）
     - Notionページとの整合性確保による正確な端子順序
     - 線の色による識別方法の追加
   - **接続手順の安全性向上**:
     - 逆接続による故障リスクの警告
     - 端子配置確認の重要性強調

4. **統合プログラミング課題の構造化** ✅
   - **段階的学習設計**:
     - DIST_OBS値設定の理論的根拠（推奨値20cm）
     - 2つのHintプログラムを統合する具体的手順
     - エラー処理（distance=None）の実装方法
   - **コメント形式プログラム雛形**:
     - while文、条件分岐などの基本構造を提供
     - 「ここに何を書く」形式での段階的実装ガイド
     - import文からメインループまでの完全な構造

5. **トラブルシューティング体系の構築** ✅
   - **実践的問題解決**:
     - OSError: [Errno 5] EIO エラーの解決（金属部品ショート対策）
     - 超音波センサー異常値対応
     - プログラム停止時の対処法
   - **アクセス性向上**:
     - ページ下部に集約して手順書の流れを維持
     - 該当箇所からのリンク参照方式

#### 技術的改善

6. **mdBook活用技術の向上** ✅
   - **アンカーリンク問題の解決**:
     - 問題：`{#anchor}` 記法がレンダリング時に表示される
     - 解決：`<a id="anchor"></a>` + 見出し の確実な方法
     - 知見記録：anchor_links_in_mdbook.md として独立ファイル化
   - **プロジェクトタイトル決定**:
     - 検討過程：Tech Notes → Essential Notes への展開
     - 最終決定：「IRLab Essential Notes」
     - book.tomlでの正式設定完了

7. **ファイル構成の最適化** ✅
   - **コンテンツ分離**:
     - 今週用：robot_basis_250710.md（モーター + 超音波センサー）
     - 来週用：oled_connector_250717.md（OLED関連作業）
   - **SUMMARY.md管理**:
     - コメントアウト機能活用（`<!-- -->`）
     - カテゴリ別整理（ロボット制御、mdBook使い方、エディタ・ツール）

#### 変更されたファイル
- **robot_basis_250710.md**: 大幅な内容強化と構成改善
- **oled_connector_250717.md**: 新規作成（次週用手順書）
- **anchor_links_in_mdbook.md**: 新規作成（mdBook技術ノート）
- **SUMMARY.md**: ファイル追加とコメントアウト管理
- **book.toml**: タイトル設定
- **how_to_embed_code_from_files.md**: アンカーリンク部分を分離

#### 教育効果の向上

**学習の段階性**:
1. モーター単体制御の理解
2. センサーとの統合プログラミング
3. 実機での動作確認

**実践的スキル**:
- ハードウェアトラブルシューティング
- 段階的デバッグ手法
- 安全な実験手順

**協働学習促進**:
- 2名1組での効果的な役割分担
- 知識共有の仕組み

#### 技術的詳細
- **開発時間**: 約3時間の集中セッション
- **主要ツール**: Claude Code、mdBook、Git
- **画像追加**: 1件（拡張ボード電源スイッチ）
- **新規ファイル**: 2件
- **既存ファイル修正**: 4件

#### 現在の状況
- **完成度**: 実験用手順書として高い完成度
- **次のステップ**: 実際の実験での検証とフィードバック収集
- **課題**: 
  - 学生の理解度に応じた内容調整の可能性
  - 実験時間内での完了可能性の確認
  - トラブル事例の実際の有効性検証

---

## 2025-07-12: 画像管理システムの中央集約化と講義ノートの修正

### 実施内容

#### 1. 画像リンクチェックと修正
- **attachment形式リンクの発見**: `teaching_advanced/lesson1.md`で6件のObsidian由来の壊れたリンクを特定
- **PDF→PNG変換**: ImageMagickを使用して5つのPDFファイルをPNG形式に変換
- **リンク修正**: すべてのattachment形式リンクを`./images/`形式に修正

#### 2. 中央集約型画像管理への移行
**移行対象ファイル**:
```
teaching_advanced/images/ → src/images/
- bme280の場所.png → teaching-bme280-location.png
- bme280_floatのコピー.png → teaching-bme280-float-copy.png  
- bme280を貼り付け.png → teaching-bme280-paste.png
- 名前をつけて保存.png → teaching-thonny-save-as.png
- picoを選択.png → teaching-thonny-select-pico.png
- ファイル名を指定して保存.png → teaching-thonny-save-filename.png
```

**命名規則の適用**:
- `teaching-`プレフィックスによるカテゴリ分類
- 英語・ハイフン区切りでの統一
- 説明的な名前による内容の明確化

#### 3. リンク更新とクリーンアップ
- **記事内リンク**: 6件のリンクを`./images/`から`../images/`に更新
- **ディレクトリ整理**: 空になった`teaching_advanced/images/`を削除
- **不要ファイル除去**: 変換済みPDFファイルの削除

#### 4. 講義ノートの内容追加
- **新セクション追加**: 「3. センサー値をOLEDディスプレイで表示する」
- **ファイル埋め込み機能**: `{{#include oled.py}}`による外部ファイル参照
- **ルール適合性確認**: CLAUDE.mdガイドラインとの整合性検証

### 技術的成果

#### 画像管理システムの確立
**中央集約のメリット**:
- 記事移動時の画像リンク切れ防止
- 重複ファイルの回避
- 一貫した命名規則による管理性向上

**現在の画像構成**:
```
src/images/
├── teaching-*.png (10件) # 教育関連画像
├── robot-*.jpg          # ロボット制御関連（予約）
└── raspberry-*.png      # Raspberry Pi関連（予約）
```

#### mdBook機能の活用拡大
- **ファイル埋め込み**: コード分離による保守性向上
- **admonishカルアウト**: 視覚的な情報強調
- **動画埋め込み**: マルチメディア教材の充実

#### 文書品質の向上
- **メタ情報統一**: 全記事で一貫したフォーマット使用
- **用語統一**: 「センサー」など技術用語の表記統一
- **構造化**: 段階的な学習プロセスの明確化

### 開発プロセスの改善

#### 問題解決のアプローチ
1. **現状分析**: Grep・Bashツールによる全件チェック
2. **段階的修正**: PDF変換→リンク修正→移動→検証の順次実行
3. **ルール確認**: CLAUDE.mdガイドラインとの照合

#### 作業効率化
- **一括処理**: sedコマンドによる複数リンクの同時更新
- **検証自動化**: grepパターンマッチングによる品質確認
- **クリーンアップ**: 不要ファイルの確実な除去

### 教育コンテンツの充実

#### 実践的な学習内容
- **ハードウェア操作**: BME280センサーとPicoの接続
- **ソフトウェア開発**: Thonnyを使ったMicroPython開発
- **システム統合**: センサー+OLED+データ保存の複合システム

#### 学習支援機能
- **視覚的ガイド**: 手順ごとのスクリーンショット
- **コード分離**: `oled.py`による再利用可能なコンポーネント
- **段階的構成**: 基礎→応用への自然な学習フロー

---

## 2025-07-12 (continued): matplotlib対処法の追加と開発環境の改善

### matplotlib troubleshooting記事の整備

#### 1. 新規記事の作成
- **記事名変更**: `Pythonでグラフが表示されません.md` → `matplotlib-troubleshooting.md`
- **理由**: 日本語ファイル名によるリンク問題の解決，mdBook互換性向上

#### 2. Obsidian→mdBook記法変換
**変換内容**:
```markdown
# 変換前（Obsidian記法）
![[./assets/Screenshot 2023-11-08 at 9.22.34.png]]

# 変換後（mdBook記法）
![matplotlibエラー](../images/teaching-matplotlib-error.png)
```

**追加機能**:
- メタ情報ブロックの統一
- admonishカルアウトの活用
- セクション構造化による可読性向上

#### 3. 画像管理の完全統一
**移動対象**:
```
teaching_advanced/assets/ → src/images/
- teaching-matplotlib-error.png
- teaching-thonny-tools-menu.png
- teaching-matplotlib-search.png  
- teaching-matplotlib-select.png
- teaching-matplotlib-install.png
```

**SUMMARY.md統合**:
```markdown
- [講義ノート1回目](teaching_advanced/lesson1.md)
    - [Pythonでグラフが表示されない場合の対処法](teaching_advanced/matplotlib-troubleshooting.md)
```

### 開発環境の改善

#### Claude Code + Neovim連携問題の解決
**問題**: Claude Codeからneovimにフォーカス復帰時，勝手にVisual modeに入る

**原因分析**:
- `mouse=nvi`設定によるマウスイベント誤認識
- フォーカス切り替え時のマウスプロトコル不安定性

**解決方法**:
```lua
-- init.lua に追加
vim.opt.mouse = 'a'
```

**技術的詳細**:
- **Neovim**: `ttymouse`オプション不要（内部自動処理）
- **Vim vs Neovim**: 設定方法の違いを確認
- **マウスプロトコル**: `nvi`より`a`が安定

### 成果と学習効果

#### 文書品質の向上
- **実用性**: 学生が実際に遭遇する問題への対処法
- **視覚的**: ステップバイステップのスクリーンショット
- **アクセシビリティ**: SUMMARY.mdからの直接アクセス可能

#### 開発効率の改善
- **フォーカス切り替え**: ストレスフリーな環境構築
- **画像管理**: 完全中央集約化の実現
- **記法統一**: Obsidian→mdBook変換ノウハウ蓄積

#### プロジェクト管理の洗練
- **ファイル命名**: 英語化による互換性確保
- **リンク管理**: 相対パス統一による保守性向上
- **構造化**: 階層的な情報整理

### セッション完了状況（2025-07-12）

#### ✅ 完了した作業
1. **画像管理システム完全統一**: 全教育コンテンツの中央集約化完了
2. **matplotlib対処法記事**: Obsidian→mdBook変換，SUMMARY.md統合完了
3. **リアルタイムグラフプログラム**: PC・Pico両側のプログラム作成完了
4. **開発環境最適化**: Claude Code + Neovim連携問題解決
5. **講義ノート1拡張**: OLED表示・データ保存セクション追加完了

#### 📊 現在のプロジェクト状況
- **記事数**: メイン教育コンテンツ 4件，技術ノート 9件
- **画像管理**: 中央集約型完全移行（teaching-* 15件）
- **コード資産**: Python実習用プログラム 4件
- **文書品質**: CLAUDE.mdルール準拠，メタ情報統一

#### 🎯 明日以降の継続作業候補
1. **実験実施**: lesson1.mdの内容で実際の授業実施
2. **フィードバック収集**: 学生からの使用感・理解度確認
3. **lesson2.md拡張**: 次回講義の詳細コンテンツ作成
4. **OLED関連手順書**: より詳細な配線・設定手順
5. **他セクションへの画像管理適用**: robot_basis等への展開
6. **新技術ノート**: 開発環境最適化ナレッジの体系化

#### 💡 取得したノウハウ
- **Obsidian→mdBook移行パターン**: 記法変換・画像移動の標準手順
- **中央集約型画像管理**: 命名規則・ディレクトリ構成・リンク更新プロセス
- **開発環境連携**: Claude Code + Neovim の最適設定
- **教育コンテンツ設計**: 段階的学習・実用的対処法・視覚的ガイド

---

**📝 再開時の参考情報**:
- **最新状況**: PROGRESS.md全体を確認
- **ファイル構成**: src/teaching_advanced/ の全ファイルが最新
- **画像管理**: src/images/ に全画像統合済み
- **開発環境**: Neovim設定 `vim.opt.mouse = 'a'` 適用済み

## 参考情報
- **主要参考**: Notion（超音波センサー接続情報）
- **開発環境**: macOS + Claude Code + mdBook
- **デプロイ**: GitHub Pages
- **画像管理**: images/ ディレクトリ
- **用語統一**: CLAUDE.md による統一規則