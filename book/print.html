<!DOCTYPE HTML>
<html lang="jp" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>IRLab. Essential Notes</title>
        <meta name="robots" content="noindex" />


        <!-- Custom HTML head -->
        
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        <link rel="stylesheet" href="theme/custom.css">

        <!-- MathJax -->
        <script async type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded affix "><a href="index.html">Introduction</a></li><li class="chapter-item expanded affix "><li class="part-title">ロボット制御基礎手順書</li><li class="chapter-item expanded "><a href="robot_basis_250710.html"><strong aria-hidden="true">1.</strong> ロボット制御基礎手順書</a></li><li class="chapter-item expanded affix "><li class="part-title">エディタ・ツール</li><li class="chapter-item expanded "><a href="nvim_cursor_jump.html"><strong aria-hidden="true">2.</strong> nvimでカーソルジャンプ</a></li><li class="chapter-item expanded affix "><li class="part-title">Raspberry Pi</li><li class="chapter-item expanded "><a href="raspberrypi_japanese_input_fix.html"><strong aria-hidden="true">3.</strong> Raspberry Pi 4でLXTerminalの日本語入力問題を解決する方法</a></li><li class="chapter-item expanded affix "><li class="part-title">mdBookの使い方</li><li class="chapter-item expanded "><a href="how_to_deploy_from_gh-pages.html"><strong aria-hidden="true">4.</strong> gh-pagesでmdbookを公開する</a></li><li class="chapter-item expanded "><a href="how_to_embed_code_from_files.html"><strong aria-hidden="true">5.</strong> mdbookにコードを埋め込む</a></li><li class="chapter-item expanded "><a href="anchor_links_in_mdbook.html"><strong aria-hidden="true">6.</strong> mdBookでのアンカーリンク設定</a></li><li class="chapter-item expanded "><a href="css_tips_for_mdbook.html"><strong aria-hidden="true">7.</strong> mdBookでのCSS開発Tips</a></li><li class="chapter-item expanded "><a href="how_to_embed_imagefile.html"><strong aria-hidden="true">8.</strong> 画像の埋め込み</a></li><li class="chapter-item expanded "><a href="how_to_use_playground.html"><strong aria-hidden="true">9.</strong> mdbook内でRustコードの実行</a></li><li class="chapter-item expanded "><a href="icon.html"><strong aria-hidden="true">10.</strong> よく使うアイコン一覧</a></li><li class="chapter-item expanded affix "><li class="part-title">About</li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">IRLab. Essential Notes</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="introduction"><a class="header" href="#introduction">Introduction</a></h1>
<!--
これは，`mdBook` を作成する練習です．いろいろな機能を試しています．
まずは，公式のユーザーガイドである，[mdBook Documentation](https://rust-lang.github.io/mdBook/)
を参照していくのが良いでしょう．
-->
<div style="break-before: page; page-break-before: always;"></div><h1 id="ロボット制御基礎手順書"><a class="header" href="#ロボット制御基礎手順書">ロボット制御基礎手順書</a></h1>
<p><strong>Create date:</strong> 2025-07-09<br />
<strong>Modified date:</strong> 2025-07-10</p>
<p>2025/7/10 (Thu) 13:00 -- 14:30<br />
<strong>実験の様子を写真に残しておいてください</strong></p>
<h2 id="作業分担2名1組"><a class="header" href="#作業分担2名1組">作業分担（2名1組）</a></h2>
<p><strong>全体（13:00-14:30）：協力作業</strong></p>
<ul>
<li>協力してプログラミング実験を実施</li>
</ul>
<h2 id="実験内容"><a class="header" href="#実験内容">実験内容</a></h2>
<ol>
<li>ロボットの前進・後退制御</li>
<li>超音波センサーを使ったモーターのON/OFF 制御</li>
<li>前方障害物手前での停止処理</li>
</ol>
<hr />
<h2 id="1-ロボットの前進後退制御"><a class="header" href="#1-ロボットの前進後退制御">1. ロボットの前進・後退制御</a></h2>
<p>ロボットは2個のモーターで左右の車輪を制御します．両方のタイヤが正しく前進・後退方向に回転するようにしてください．</p>
<h3 id="基本的な制御方法"><a class="header" href="#基本的な制御方法">基本的な制御方法</a></h3>
<pre><code class="language-python">board.motorOn(MOTOR_NUM, DIRECTION, SPEED)
# MOTOR_NUM: 1, 2 で指令を出すモーターを変更
# DIRECTION: &quot;f&quot;, &quot;r&quot; で正回転/逆回転を切り替え
# SPEED: 0 -- 100% でモータースピードを制御
</code></pre>
<h3 id="独立二輪駆動制御の考え方"><a class="header" href="#独立二輪駆動制御の考え方">独立二輪駆動制御の考え方</a></h3>
<p>ロボットの前進・後退は，左右のモーターの回転方向の組み合わせで決まります．
<strong>配線の向きによって，前進に必要な回転方向の組み合わせが異なります</strong>．</p>
<p><strong>想定される組み合わせパターン：</strong></p>
<ul>
<li>パターン1：<code>motor1=&quot;f&quot;, motor2=&quot;r&quot;</code></li>
<li>パターン2：<code>motor1=&quot;f&quot;, motor2=&quot;f&quot;</code></li>
<li>パターン3：<code>motor1=&quot;r&quot;, motor2=&quot;r&quot;</code></li>
<li>パターン4：<code>motor1=&quot;r&quot;, motor2=&quot;f&quot;</code></li>
</ul>
<p><strong>f</strong>: forward (CW，時計回り，正転)<br>
<strong>r</strong>: reverse (CCW，反時計回り，逆転)<br>
どちらが正転になるかはモーターによります．</p>
<h3 id="実験手順"><a class="header" href="#実験手順">実験手順</a></h3>
<ol>
<li>
<p><strong>事前準備</strong></p>
<ul>
<li>バッテリーを接続する </li>
<li><strong>拡張ボードのスライドスイッチをONにする</strong>（モーター動作に必要）</li>
</ul>
<p><img src="images/%E6%8B%A1%E5%BC%B5%E3%83%9C%E3%83%BC%E3%83%89%E9%9B%BB%E6%BA%90%E3%82%B9%E3%82%A4%E3%83%83%E3%83%81.JPG" alt="拡張ボード電源スイッチ" /></p>
<ul>
<li>安全な場所で実験を行う</li>
</ul>
</li>
<li>
<p><strong>前進方向の確認</strong></p>
<ul>
<li>下記の<a href="robot_basis_250710.html#patterncheck">パターン確認プログラム</a>を実行する</li>
<li>各パターンを試し，ロボットが前進する組み合わせを見つける</li>
<li>前進が確認できたら，後退（逆の組み合わせ）も確認</li>
</ul>
</li>
<li>
<p><strong>テスト用プログラムの作成</strong></p>
<ul>
<li>下記の<a href="robot_basis_250710.html#hintmotor">Hintプログラム</a>を参考に，両輪を同時に制御するプログラムを作成</li>
<li>まず<code>SPEED = 30</code>程度の低速で動作確認</li>
</ul>
</li>
<li>
<p><strong>速度の調整</strong></p>
<ul>
<li>前進・後退の組み合わせが確定したら，いろいろな速度を試す</li>
<li>例：<code>SPEED = 50</code>（制御しやすいかもしれない速度）</li>
</ul>
</li>
<li>
<p><strong>実験終了</strong></p>
<ul>
<li><strong>実験終了時は，スライドスイッチをOFFにする</strong></li>
</ul>
</li>
</ol>
<p><strong>注意事項：</strong></p>
<ul>
<li><strong>モーター実験前に必ずスライドスイッチをON，実験後にOFFにする</strong></li>
<li>必ず低速（30以下）から開始し，安全を確認してから速度を上げる</li>
<li>ロボットが予期しない方向に動いた場合は，すぐに停止する</li>
<li>各グループで配線状態が異なる可能性があるため，必ず実際に動作確認を行う</li>
<li>エラーが発生した場合は<a href="robot_basis_250710.html#%E3%83%88%E3%83%A9%E3%83%96%E3%83%AB%E3%82%B7%E3%83%A5%E3%83%BC%E3%83%86%E3%82%A3%E3%83%B3%E3%82%B0">トラブルシューティング</a>を参照</li>
</ul>
<p><a id="patterncheck"></a></p>
<h3 id="前進後退パターン確認プログラム"><a class="header" href="#前進後退パターン確認プログラム">前進・後退パターン確認プログラム</a></h3>
<p>4つの組み合わせパターンを順番にテストして，どのパターンで前進するかを確認してください．</p>
<pre><code class="language-python">import PicoRobotics
import utime

# --- ボードとモーター設定
board = PicoRobotics.KitronikPicoRobotics()

# 初期状態：両輪停止
board.motorOn(1, &quot;f&quot;, 0)
board.motorOn(2, &quot;f&quot;, 0)

# --- 前進・後退のテスト
print(&quot;前進・後退テスト開始&quot;)

# パターン1: motor1=&quot;f&quot;, motor2=&quot;r&quot; を試す
print(&quot;パターン1: motor1=f, motor2=r&quot;)
board.motorOn(1, &quot;f&quot;, 30)  # 左輪
board.motorOn(2, &quot;r&quot;, 30)  # 右輪
utime.sleep_ms(2000)      # 2秒間動作

# 停止
board.motorOn(1, &quot;f&quot;, 0)
board.motorOn(2, &quot;f&quot;, 0)
utime.sleep_ms(1000)      # 1秒間停止

# パターン2: motor1=&quot;f&quot;, motor2=&quot;f&quot; を試す
print(&quot;パターン2: motor1=f, motor2=f&quot;)
board.motorOn(1, &quot;f&quot;, 30)
board.motorOn(2, &quot;f&quot;, 30)
utime.sleep_ms(2000)

# 停止
board.motorOn(1, &quot;f&quot;, 0)
board.motorOn(2, &quot;f&quot;, 0)
utime.sleep_ms(1000)

# パターン3: motor1=&quot;r&quot;, motor2=&quot;r&quot; を試す
print(&quot;パターン3: motor1=r, motor2=r&quot;)
board.motorOn(1, &quot;r&quot;, 30)
board.motorOn(2, &quot;r&quot;, 30)
utime.sleep_ms(2000)

# 停止
board.motorOn(1, &quot;f&quot;, 0)
board.motorOn(2, &quot;f&quot;, 0)
utime.sleep_ms(1000)

# パターン4: motor1=&quot;r&quot;, motor2=&quot;f&quot; を試す
print(&quot;パターン4: motor1=r, motor2=f&quot;)
board.motorOn(1, &quot;r&quot;, 30)
board.motorOn(2, &quot;f&quot;, 30)
utime.sleep_ms(2000)

# 最終停止
board.motorOn(1, &quot;f&quot;, 0)
board.motorOn(2, &quot;f&quot;, 0)
print(&quot;テスト完了&quot;)
</code></pre>
<p><a id="hintmotor"></a></p>
<h3 id="hint-モーターの回転制御プログラム"><a class="header" href="#hint-モーターの回転制御プログラム">Hint: モーターの回転制御プログラム</a></h3>
<p>前進パターンが分かったら，以下の雛形を使って指定秒だけ前進するプログラムを作成してください．</p>
<pre><code class="language-python">import PicoRobotics
import utime

# --- ボードとモーター設定
board = PicoRobotics.KitronikPicoRobotics()

# 初期状態：両輪停止
board.motorOn(1, &quot;f&quot;, 0)
board.motorOn(2, &quot;f&quot;, 0)

# --- 前進設定（確認プログラムで見つけたパターンを使用）
MOTOR1_DIR = &quot;f&quot;  # 前進時のモーター1の方向（&quot;f&quot;または&quot;r&quot;に設定）
MOTOR2_DIR = &quot;r&quot;  # 前進時のモーター2の方向（&quot;f&quot;または&quot;r&quot;に設定）
SPEED = 50        # モーター速度（0-100）
FORWARD_TIME = 3000  # 前進時間（ミリ秒）

# --- 前進動作
print(&quot;前進開始&quot;)
board.motorOn(1, MOTOR1_DIR, SPEED)
board.motorOn(2, MOTOR2_DIR, SPEED)
utime.sleep_ms(FORWARD_TIME)

# --- 停止
board.motorOn(1, &quot;f&quot;, 0)
board.motorOn(2, &quot;f&quot;, 0)
print(&quot;停止&quot;)
</code></pre>
<h2 id="2-超音波センサーを使ったモーターのonoff-制御"><a class="header" href="#2-超音波センサーを使ったモーターのonoff-制御">2. 超音波センサーを使ったモーターのON/OFF 制御</a></h2>
<p>車体前方に設置した超音波センサーで，前方の障害物までの距離を読み取ってください．
障害物判定をする距離を，ここでは<code>DIST_OBS</code>と呼ぶことにします．</p>
<h3 id="超音波センサーの接続について"><a class="header" href="#超音波センサーの接続について">超音波センサーの接続について</a></h3>
<p><strong>重要：コネクター接続時は端子の役割を必ず合わせてください</strong></p>
<p>超音波センサーには4つの端子があります：</p>
<ul>
<li><strong>VCC</strong>: 電源（3.3V）- 赤線</li>
<li><strong>TRIG</strong>: トリガー信号（GP0/Pin 0に接続）- 黄線</li>
<li><strong>ECHO</strong>: エコー信号（GP1/Pin 1に接続）- 白線</li>
<li><strong>GND</strong>: グラウンド - 黒線</li>
</ul>
<p><strong>接続手順：</strong></p>
<ol>
<li>センサー側とボード側のコネクター端子配置を確認</li>
<li>線の色と役割を確認：赤（VCC-3.3V），黄（TRIG-GP0），白（ECHO-GP1），黒（GND）</li>
<li>逆接続すると故障の原因となるため，接続前に必ず確認</li>
</ol>
<h3 id="dist_obsの値設定について"><a class="header" href="#dist_obsの値設定について">DIST_OBSの値設定について</a></h3>
<p><strong>推奨値：<code>DIST_OBS = 20</code>（cm）</strong></p>
<p>値の設定における検討事項：</p>
<ul>
<li><strong>安全性</strong>：ロボットが障害物に衝突する前に十分な余裕を持って停止できる</li>
<li><strong>センサー特性</strong>：超音波センサーは近距離（5cm未満）では正確な測定が困難</li>
<li><strong>実験環境</strong>：テーブル上での実験に適した距離で，壁や机の端を適切に検出可能</li>
<li><strong>反応時間</strong>：モーターの停止やプログラムの処理時間を考慮した安全マージン</li>
</ul>
<p><strong>実験手順：</strong></p>
<ol>
<li>まず<code>DIST_OBS = 20</code>で動作確認</li>
<li>動作が安定したら，10cm，30cmなど異なる値で動作の違いを観察</li>
<li>最適な値を各グループで検討</li>
</ol>
<p><code>DIST_OBS</code>の値を設定し，計測距離とそれを比較して，
障害物が前方になければモーターを回転，そうでなければ停止としてください．</p>
<h3 id="プログラミング課題"><a class="header" href="#プログラミング課題">プログラミング課題</a></h3>
<p>以下の2つのHintプログラムを参考にして，<strong>超音波センサーとモーター制御を組み合わせた完成プログラム</strong>を作成してください．</p>
<p><strong>課題の要求仕様：</strong></p>
<ol>
<li>超音波センサーで前方の距離を測定</li>
<li>測定距離が<code>DIST_OBS</code>より大きい場合：モーターを回転（前進）</li>
<li>測定距離が<code>DIST_OBS</code>以下の場合：モーターを停止</li>
<li>上記の処理を繰り返し実行</li>
</ol>
<p><strong>プログラム作成手順：</strong></p>
<ol>
<li>
<p><strong>前進パターンの確認</strong></p>
<ul>
<li>「## 1」で確定した前進パターンを確認（MOTOR1_DIR, MOTOR2_DIR）</li>
</ul>
</li>
<li>
<p><strong>基本構造の準備</strong></p>
<ul>
<li>「Hint: モーターの回転制御プログラム」のimport部分とboard設定をコピー</li>
<li>「Hint: 超音波センサー距離計測プログラム」のmeasure_distance()関数をコピー</li>
<li>「Hint: 超音波センサー距離計測プログラム」のピン設定（TRIG, ECHO）をコピー</li>
</ul>
</li>
<li>
<p><strong>統合プログラムの作成</strong></p>
<ul>
<li><code>DIST_OBS = 20</code>を設定</li>
<li>前進パターンを変数で設定（MOTOR1_DIR, MOTOR2_DIR）</li>
<li>while文でループ処理を作成</li>
<li>条件分岐で距離に応じたモーター制御を実装</li>
</ul>
</li>
<li>
<p><strong>動作確認</strong></p>
<ul>
<li>障害物なしの状態で前進するかテスト</li>
<li>障害物ありの状態で停止するかテスト</li>
</ul>
</li>
</ol>
<p><strong>具体的な統合のポイント：</strong></p>
<ul>
<li><strong>measure_distance()関数</strong>：超音波センサーHintから全体をコピー</li>
<li><strong>ピン設定</strong>：TRIG = Pin(0, Pin.OUT), ECHO = Pin(1, Pin.IN)</li>
<li><strong>前進制御</strong>：「## 1」で確定したパターンを使用</li>
<li><strong>ループ制御</strong>：while文でutime.sleep_ms(100)程度の間隔で繰り返し</li>
</ul>
<p><strong>エラー処理について：</strong>
<code>distance</code>が<code>None</code>の場合は，安全のためモーターを停止する</p>
<pre><code class="language-python"># ## 1で確定した前進パターンを使用
MOTOR1_DIR = &quot;f&quot;  # 前進時のモーター1方向（実際の値に変更）
MOTOR2_DIR = &quot;r&quot;  # 前進時のモーター2方向（実際の値に変更）
SPEED = 50

distance = measure_distance()
if distance is None:
    # 測定失敗時は停止
    board.motorOn(1, &quot;f&quot;, 0)
    board.motorOn(2, &quot;f&quot;, 0)
else:
    # 通常の距離判定処理
    if distance &gt; DIST_OBS:
        # 前進
        board.motorOn(1, MOTOR1_DIR, SPEED)
        board.motorOn(2, MOTOR2_DIR, SPEED)
    else:
        # 停止
        board.motorOn(1, &quot;f&quot;, 0)
        board.motorOn(2, &quot;f&quot;, 0)
</code></pre>
<h3 id="統合プログラムのヒント"><a class="header" href="#統合プログラムのヒント">統合プログラムのヒント</a></h3>
<p>以下の雛形を参考に，統合プログラムを作成してください．</p>
<pre><code class="language-python"># ここにimport文を書く（PicoRobotics, utime, machine関連）

# ここに超音波センサー距離計測関数をコピー
def measure_distance():
    # 超音波センサーHintから全体をコピー
    pass

# ここにピン設定をコピー（TRIG, ECHO）

# ここにボード設定を書く（PicoRobotics.KitronikPicoRobotics()）

# 初期状態：両輪停止
# ここにモーター停止命令を書く

# 設定値
DIST_OBS = 20  # 障害物判定距離（cm）
MOTOR1_DIR = &quot;f&quot;  # 前進時のモーター1方向（## 1の結果に変更）
MOTOR2_DIR = &quot;r&quot;  # 前進時のモーター2方向（## 1の結果に変更）
SPEED = 50

# メインループ
MAX_RUN_COUNT = 1000
count = 0

while count &lt; MAX_RUN_COUNT:
    # ここで距離を測定
    # distance = measure_distance()
    
    # ここでエラー処理（distance is None）
    if distance is None:
        # 測定失敗時：両輪停止
        pass
    else:
        # 通常の距離判定
        if distance &gt; DIST_OBS:
            # 前進：両輪を前進パターンで回転
            pass
        else:
            # 停止：両輪停止
            pass
    
    # ここで短い待機時間
    # utime.sleep_ms(100)
    
    count += 1

# 最終停止
# ここに最終的な両輪停止命令を書く
</code></pre>
<h3 id="hint-超音波センサー距離計測プログラムのサンプル"><a class="header" href="#hint-超音波センサー距離計測プログラムのサンプル">Hint: 超音波センサー距離計測プログラムのサンプル</a></h3>
<pre><code class="language-python"># 超音波センサー距離計測実験プログラム
import utime
from machine import Pin, PWM, reset, time_pulse_us, I2C
import time

#======&lt;ここから超音波センサーの準備として必要&gt;=====
def measure_distance():
    # Trigピンを10us HIGHにする
    TRIG.value(1)
    time.sleep_us(10)
    TRIG.value(0)
    
    # EchoピンのHIGHパルスの長さを計測
    duration = time_pulse_us(ECHO, 1, 30000)  # タイムアウト: 30ms
    
    # タイムアウト時の処理
    if duration &lt; 0:
        return None  # 測定失敗

    # 音速を340 m/sと仮定して距離を計算
    distance = (duration * 0.0343) / 2  # 単位: cm
    
    return distance

# 超音波センサーの設定
# - TrigとEchoピンの設定
TRIG = Pin(0, Pin.OUT)
ECHO = Pin(1, Pin.IN)
# - TrigピンをLOWに設定しておく
TRIG.value(0)
utime.sleep_ms(2000)
#======&lt;ここまで&gt;=====

#======&lt;超音波センサーの使い方&gt;=====
distance = measure_distance()
print(&quot;Dist : {} cm&quot;.format(float(distance)))
utime.sleep_ms(10)
#======&lt;ここまで&gt;=====
</code></pre>
<h2 id="3-前方障害物手前での停止処理"><a class="header" href="#3-前方障害物手前での停止処理">3. 前方障害物手前での停止処理</a></h2>
<p>「## 2」で作成したプログラムを使用して，実際の動作確認を行います．</p>
<h3 id="実験手順-1"><a class="header" href="#実験手順-1">実験手順</a></h3>
<ol>
<li><strong>安全な場所でテスト</strong>：床またはテーブル上で実施</li>
<li><strong>障害物の設置</strong>：本，箱などをロボットの前方に配置</li>
<li><strong>プログラム実行</strong>：作成したプログラムを実行し，停止動作を確認</li>
<li><strong>距離の調整</strong>：必要に応じてDIST_OBSの値を調整</li>
</ol>
<h3 id="確認ポイント"><a class="header" href="#確認ポイント">確認ポイント</a></h3>
<ul>
<li>障害物手前で確実に停止するか</li>
<li>障害物がない時は前進するか</li>
</ul>
<hr />
<h2 id="トラブルシューティング"><a class="header" href="#トラブルシューティング">トラブルシューティング</a></h2>
<h3 id="モーター制御でエラーが発生する場合"><a class="header" href="#モーター制御でエラーが発生する場合">モーター制御でエラーが発生する場合</a></h3>
<h4 id="oserror-errno-5-eio-エラー"><a class="header" href="#oserror-errno-5-eio-エラー">OSError: [Errno 5] EIO エラー</a></h4>
<p><strong>症状：</strong> <code>board.motorOn()</code>実行時にI/Oエラーが発生</p>
<p><strong>主な原因と対処法：</strong></p>
<ol>
<li>
<p><strong>金属部品のショート</strong></p>
<ul>
<li>エンコーダー基板周辺でネジなどの金属部品が吸着していないか確認</li>
<li>異物を除去し，金属部品が基板に接触していないことを確認</li>
</ul>
</li>
<li>
<p><strong>配線の問題</strong></p>
<ul>
<li>モーター配線が正しく接続されているか確認</li>
<li>配線の断線や接触不良がないか確認</li>
</ul>
</li>
<li>
<p><strong>電源の問題</strong></p>
<ul>
<li>バッテリー残量を確認</li>
<li>電源供給が安定しているか確認</li>
</ul>
</li>
</ol>
<h4 id="超音波センサーで異常な値が表示される場合"><a class="header" href="#超音波センサーで異常な値が表示される場合">超音波センサーで異常な値が表示される場合</a></h4>
<p><strong>症状：</strong> 距離測定で<code>None</code>や異常に大きな値が返される</p>
<p><strong>対処法：</strong></p>
<ul>
<li>センサー前方に障害物がないか確認</li>
<li>TRIGピン，ECHOピンの配線確認</li>
<li>センサーの向きが正しいか確認</li>
</ul>
<h4 id="プログラムが途中で停止する場合"><a class="header" href="#プログラムが途中で停止する場合">プログラムが途中で停止する場合</a></h4>
<p><strong>対処法：</strong></p>
<ul>
<li>エラーメッセージを確認し，該当するエラーの対処法を実施</li>
<li>ハードウェアの接続状態を再確認</li>
<li>プログラムを最初から再実行</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="nvimでカーソルジャンプ"><a class="header" href="#nvimでカーソルジャンプ">nvimでカーソルジャンプ</a></h1>
<p><strong>Create date:</strong> 2025-07-09<br />
<strong>Modified date:</strong> 2025-07-10</p>
<p>Neovimでのカーソル移動は効率的な編集の基本です．基本的な移動から高度なジャンプまで，主要な機能を紹介します．</p>
<h2 id="基本的なカーソル移動"><a class="header" href="#基本的なカーソル移動">基本的なカーソル移動</a></h2>
<h3 id="文字単位の移動"><a class="header" href="#文字単位の移動">文字単位の移動</a></h3>
<ul>
<li><code>h</code> - 左に1文字</li>
<li><code>j</code> - 下に1行</li>
<li><code>k</code> - 上に1行</li>
<li><code>l</code> - 右に1文字</li>
</ul>
<h3 id="単語単位の移動"><a class="header" href="#単語単位の移動">単語単位の移動</a></h3>
<ul>
<li><code>w</code> - 次の単語の先頭へ</li>
<li><code>b</code> - 前の単語の先頭へ</li>
<li><code>e</code> - 現在の単語の末尾へ</li>
<li><code>ge</code> - 前の単語の末尾へ</li>
</ul>
<h2 id="行内での移動"><a class="header" href="#行内での移動">行内での移動</a></h2>
<h3 id="行の端への移動"><a class="header" href="#行の端への移動">行の端への移動</a></h3>
<ul>
<li><code>0</code> - 行の先頭へ</li>
<li><code>^</code> - 行の最初の非空白文字へ</li>
<li><code>$</code> - 行の末尾へ</li>
</ul>
<h3 id="文字検索"><a class="header" href="#文字検索">文字検索</a></h3>
<ul>
<li><code>f{文字}</code> - 行内で指定文字を右方向に検索</li>
<li><code>F{文字}</code> - 行内で指定文字を左方向に検索</li>
<li><code>t{文字}</code> - 指定文字の直前まで右方向に移動</li>
<li><code>T{文字}</code> - 指定文字の直後まで左方向に移動</li>
<li><code>;</code> - 直前の検索を繰り返す</li>
<li><code>,</code> - 直前の検索を逆方向に繰り返す</li>
</ul>
<h2 id="ページ単位での移動"><a class="header" href="#ページ単位での移動">ページ単位での移動</a></h2>
<h3 id="スクロール"><a class="header" href="#スクロール">スクロール</a></h3>
<ul>
<li><code>Ctrl+f</code> - 1ページ下へ</li>
<li><code>Ctrl+b</code> - 1ページ上へ</li>
<li><code>Ctrl+d</code> - 半ページ下へ</li>
<li><code>Ctrl+u</code> - 半ページ上へ</li>
</ul>
<h3 id="ファイル内の移動"><a class="header" href="#ファイル内の移動">ファイル内の移動</a></h3>
<ul>
<li><code>gg</code> - ファイルの先頭へ</li>
<li><code>G</code> - ファイルの末尾へ</li>
<li><code>{行番号}G</code> - 指定行番号へ</li>
<li><code>:{行番号}</code> - 指定行番号へ（コマンドモード）</li>
</ul>
<h2 id="高度なジャンプ機能"><a class="header" href="#高度なジャンプ機能">高度なジャンプ機能</a></h2>
<h3 id="検索ジャンプ"><a class="header" href="#検索ジャンプ">検索ジャンプ</a></h3>
<ul>
<li><code>/{検索文字列}</code> - 前方検索</li>
<li><code>?{検索文字列}</code> - 後方検索</li>
<li><code>n</code> - 次の検索結果へ</li>
<li><code>N</code> - 前の検索結果へ</li>
<li><code>*</code> - カーソル下の単語を前方検索</li>
<li><code>#</code> - カーソル下の単語を後方検索</li>
</ul>
<h3 id="マーク機能"><a class="header" href="#マーク機能">マーク機能</a></h3>
<ul>
<li><code>m{文字}</code> - 現在位置にマークを設定</li>
<li><code>'{文字}</code> - 指定マークの行へジャンプ</li>
<li><code>\</code>{文字}`` - 指定マークの正確な位置へジャンプ</li>
<li><code>''</code> - 直前の位置へ戻る</li>
<li><code>\</code>`` - 直前の正確な位置へ戻る</li>
</ul>
<h3 id="ジャンプリスト"><a class="header" href="#ジャンプリスト">ジャンプリスト</a></h3>
<ul>
<li><code>Ctrl+o</code> - 古いジャンプ位置へ戻る</li>
<li><code>Ctrl+i</code> - 新しいジャンプ位置へ進む</li>
<li><code>:jumps</code> - ジャンプリストを表示</li>
</ul>
<h3 id="括弧のマッチング"><a class="header" href="#括弧のマッチング">括弧のマッチング</a></h3>
<ul>
<li><code>%</code> - 対応する括弧にジャンプ（<code>()</code>, <code>[]</code>, <code>{}</code>）</li>
</ul>
<h2 id="実用的なテクニック"><a class="header" href="#実用的なテクニック">実用的なテクニック</a></h2>
<h3 id="数値指定での移動"><a class="header" href="#数値指定での移動">数値指定での移動</a></h3>
<ul>
<li><code>5j</code> - 5行下へ</li>
<li><code>3w</code> - 3単語先へ</li>
<li><code>2f'</code> - 2番目の<code>'</code>へ</li>
</ul>
<h3 id="段落ブロック移動"><a class="header" href="#段落ブロック移動">段落・ブロック移動</a></h3>
<ul>
<li><code>{</code> - 前の空行へ</li>
<li><code>}</code> - 次の空行へ</li>
<li><code>(</code> - 前の文の開始へ</li>
<li><code>)</code> - 次の文の開始へ</li>
</ul>
<h3 id="画面内での移動"><a class="header" href="#画面内での移動">画面内での移動</a></h3>
<ul>
<li><code>H</code> - 画面上部へ</li>
<li><code>M</code> - 画面中央へ</li>
<li><code>L</code> - 画面下部へ</li>
</ul>
<blockquote>
<p><i class="fa fa-lightbulb-o"></i> 
カーソル移動は練習により自然に身につきます．まずは基本的な <code>hjkl</code> と <code>w</code>, <code>b</code> から始めましょう．</p>
</blockquote>
<blockquote>
<p><i class="fa fa-exclamation-circle"></i>
注意: 移動コマンドは Normal モードでのみ有効です．</p>
</blockquote>
<p><a href="./"><i class="fa fa-arrow-left"></i> Home</a></p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="raspberry-pi-4でlxterminalの日本語入力問題を解決する方法"><a class="header" href="#raspberry-pi-4でlxterminalの日本語入力問題を解決する方法">Raspberry Pi 4でlxterminalの日本語入力問題を解決する方法</a></h1>
<p><strong>Create date:</strong> 2025-07-10<br />
<strong>Modified date:</strong> 2025-07-10</p>
<h2 id="問題の概要"><a class="header" href="#問題の概要">問題の概要</a></h2>
<p>Raspberry Pi 4のLXTerminalにて，日本語入力時に母音（あ，い，う，え，お）しか入力できず，
子音を含む文字が正常に入力できない現象が発生することがあります．
<code>ki</code>のようなキー入力において，一つづつ確定されているような挙動を確認できます．</p>
<h2 id="症状"><a class="header" href="#症状">症状</a></h2>
<ul>
<li>lxterminalで日本語入力モードにしても母音以外の文字が入力できない</li>
<li>他のアプリケーションでは正常に日本語入力ができる場合がある</li>
<li>英数字入力は正常に動作する</li>
</ul>
<h2 id="解決方法"><a class="header" href="#解決方法">解決方法</a></h2>
<p>以下の3つのコマンドを順番に実行することで解決できます．</p>
<pre><code class="language-bash">sudo apt install fcitx5-mozc # 1. fcitx5-mozcのインストール
im-config -n fcitx5          # 2. 入力メソッドの設定変更
sudo reboot                  # 3. システムの再起動
</code></pre>
<p>設定を確実に反映させるため，システムを再起動します．
この方法により，Raspberry Pi 4でのlxterminalの日本語入力問題を解決できます．</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="gh-pagesでmdbookを公開する"><a class="header" href="#gh-pagesでmdbookを公開する">gh-pagesでmdbookを公開する</a></h1>
<p><strong>Create date:</strong> 2025-07-05<br />
<strong>Modified date:</strong> 2025-07-05</p>
<p><code>mdbook</code>とは，rust製のオンラインドキュメント制作ツールの名称．<br />
<i class="fa fa-arrow-right"></i>
<a href="https://rust-lang.github.io/mdBook/">mdBook Documentation</a></p>
<p><code>gh-pages</code>とは，GitHubのリポジトリをWeb公開する，GitHubが提供している仕組み．<br />
<i class="fa fa-arrow-right"></i>
<a href="https://docs.github.com/en/pages/getting-started-with-github-pages/what-is-github-pages?utm_source=chatgpt.com">What is GitHub Pages?</a></p>
<blockquote>
<p><i class="fa fa-lightbulb-o"></i> 
このページ自体も<code>gh-pages</code>を使って公開しています．</p>
</blockquote>
<h2 id="mdbookをローカルで用意する"><a class="header" href="#mdbookをローカルで用意する">mdbookをローカルで用意する</a></h2>
<pre><code class="language-bash">mdbook init mybook
cd mybook
# 最初に，公開用のディクレトリをdocsという名前で作成する
mkdir docs
</code></pre>
<h2 id="githubで新しいリポジトリを作成する"><a class="header" href="#githubで新しいリポジトリを作成する">Githubで新しいリポジトリを作成する</a></h2>
<p>ここでは，<code>mybook</code> というリポジトリを作成したとする．</p>
<h2 id="mybookbookをgithubに連携させる"><a class="header" href="#mybookbookをgithubに連携させる">mybook/bookをgithubに連携させる</a></h2>
<pre><code class="language-bash"># 現在の場所: mdbookのルート
git init
echo &quot;book&quot; &gt;&gt; .gitignore
git remote add origin https://github.com/&lt;your-username&gt;/mybook.git
git add .
git commit -m &quot;deploy to GitHub Pages&quot;
git push -f origin main
</code></pre>
<h2 id="github-pages-を有効化"><a class="header" href="#github-pages-を有効化">GitHub Pages を有効化</a></h2>
<p>GitHub のリポジトリページ → Settings → Pages に行く．</p>
<ul>
<li><code>Source</code>: main ブランチを選択</li>
<li><code>Folder</code>: /docs を選択</li>
<li>保存すると、数秒〜数分で <em>https://&lt;your-username&gt;.github.io/mybook/</em> に公開される</li>
</ul>
<h2 id="mdbookを編集したらビルド公開用ディレクトリにコピーをする"><a class="header" href="#mdbookを編集したらビルド公開用ディレクトリにコピーをする">mdbookを編集したら，ビルド・公開用ディレクトリにコピーをする</a></h2>
<pre><code class="language-bash"># 何かしらmybookの中を制作
mdbook build
cp -r book/* docs/
</code></pre>
<h2 id="ページの更新"><a class="header" href="#ページの更新">ページの更新</a></h2>
<pre><code class="language-bash">git add .
git commit -m &quot;update&quot;
git push origin main
</code></pre>
<h2 id="シェルスクリプトで更新を自動化"><a class="header" href="#シェルスクリプトで更新を自動化">シェルスクリプトで更新を自動化</a></h2>
<p>以下のシェルスクリプトにより，ビルドからプッシュまでを自動化できる．</p>
<pre><code class="language-shell  numberLines">#!/bin/bash
#
# mdbook自動デプロイスクリプト
# ================================
#
# 【背景】
# mdbookのデプロイを効率化するため，
# mdbookのビルドからGit pushまでを自動化
#
# 【概要】
# 1. mdbookでビルド実行
# 2. book/からdocs/にファイルコピー
# 3. Git差分チェック（変更なしの場合はスキップ）
# 4. コミットメッセージ入力（カスタム or デフォルト）
# 5. 最終確認後にcommit/push
#
# 【使用方法】
# ./deploy.sh
#
# 作成日: 2025年7月5日

set -e  # エラーで即終了

# 色設定
GREEN=$'\e[32m'
YELLOW=$'\e[33m'
RESET=$'\e[0m'

echo -e &quot;${GREEN}🔧 ビルド中...${RESET}&quot;
mdbook build

echo -e &quot;${GREEN}📦 book/ を docs/ にコピー中...${RESET}&quot;
rm -rf docs
mkdir -p docs
cp -r book/* docs/

# 変更がない場合のハンドリング
if git diff --quiet &amp;&amp; git diff --staged --quiet; then
    echo -e &quot;${YELLOW}📋 変更がありません。スキップします。${RESET}&quot;
    exit 0
fi

echo -e &quot;${GREEN}📤 Git にコミット＆プッシュします...${RESET}&quot;
git add .

# コミットメッセージの入力を求める
echo -n &quot;コミットメッセージを入力してください (空白でデフォルト): &quot;
read -r COMMIT_MESSAGE

# タイムスタンプ生成
TIMESTAMP=$(date '+%Y-%m-%d %H:%M:%S')

# メッセージが空の場合はデフォルトメッセージを使用
if [ -z &quot;$COMMIT_MESSAGE&quot; ]; then
    COMMIT_MESSAGE=&quot;Update documentation&quot;
fi

# 最終的なコミットメッセージを表示して確認
FINAL_MESSAGE=&quot;${COMMIT_MESSAGE} - ${TIMESTAMP}&quot;
echo -e &quot;${YELLOW}コミットメッセージ: \&quot;${FINAL_MESSAGE}\&quot;${RESET}&quot;
echo -n &quot;このメッセージでコミットしますか？ (y/n): &quot;
read -r CONFIRM

if [ &quot;$CONFIRM&quot; != &quot;y&quot; ] &amp;&amp; [ &quot;$CONFIRM&quot; != &quot;Y&quot; ]; then
    echo -e &quot;${YELLOW}❌ コミットをキャンセルしました。${RESET}&quot;
    exit 1
fi

# タイムスタンプを追加してコミット
git commit -m &quot;${FINAL_MESSAGE}&quot;

git push origin main

echo -e &quot;${GREEN}✅ 完了しました！${RESET}&quot;
</code></pre>
<p><strong>使い方</strong></p>
<pre><code class="language-bash">nvim deplay.sh # 上記スクリプトを作成
chmod +x deplay.h # 実行権限を付与．最初だけで良い
./deplay.h
</code></pre>
<p><a href="./"><i class="fa fa-arrow-left"></i> Home</a></p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="mdbookにコードやファイルの内容を埋め込む"><a class="header" href="#mdbookにコードやファイルの内容を埋め込む">mdbookにコードやファイルの内容を埋め込む</a></h1>
<p><strong>Create date:</strong> 2025-07-05<br />
<strong>Modified date:</strong> 2025-07-05</p>
<p>参照: <a href="https://rust-lang.github.io/mdBook/format/mdbook.html?highlight=include#including-files">https://rust-lang.github.io/mdBook/format/mdbook.html?highlight=include#including-files</a></p>
<p>mdbookには，ローカルファイルを取り込む機能が提供されている．
手元にあるソースコードを，そのまま共有したい場合に重宝する．
ローカルファイルを修正すれば，そのままmdbookにも反映されるので，一貫性を保ちやすい．</p>
<h2 id="基本"><a class="header" href="#基本">基本</a></h2>
<pre><code class="language-markdown">{{#include relative/path/to/file}}
</code></pre>
<p>これで，<code>relative/path/to/file</code>の部分を，埋め込みたいファイルへの相対パスに変えればよい．
これは，任意のファイルの中身を埋め込む方法として使えるが，ソースコードの場合，ほとんどは
コードブロックとして表示したいと思われる．以下が，コードブロックとしての使い方である．</p>
<pre><code class="language-code">```filetype
{{#include relative/path/to/file}}
```
</code></pre>
<p><code>filetype</code>の部分には，埋め込むファイルの種類を書いておく．シンタックスハイライトが効く．</p>
<p>上の書き方で実際に使うと，以下のように埋め込まれる．</p>
<p><strong>markdown中の書き方</strong></p>
<pre><code class="language-toml">```toml
{{#include ../book.toml}}
```
</code></pre>
<p><strong>実際の表示</strong></p>
<pre><code class="language-toml">[book]
authors = [&quot;KazumichiINOUE&quot;]
language = &quot;jp&quot;
multilingual = false
src = &quot;src&quot;
title = &quot;IRLab. Essential Notes&quot;

[output.html]
mathjax-support = true
</code></pre>
<h2 id="高度な使い方"><a class="header" href="#高度な使い方">高度な使い方</a></h2>
<h3 id="埋め込む範囲を指定する"><a class="header" href="#埋め込む範囲を指定する">埋め込む範囲を指定する</a></h3>
<p><strong>指定した行だけ</strong></p>
<pre><code class="language-toml">```toml
{{#include ../book.toml:2}}
```
</code></pre>
<pre><code class="language-toml">authors = [&quot;KazumichiINOUE&quot;]
</code></pre>
<p><strong>行の範囲指定</strong></p>
<pre><code class="language-toml">```toml
{{#include ../book.toml:2:5}}
```
</code></pre>
<pre><code class="language-toml">authors = [&quot;KazumichiINOUE&quot;]
language = &quot;jp&quot;
multilingual = false
src = &quot;src&quot;
</code></pre>
<p><strong>指定した行以降</strong></p>
<pre><code class="language-toml">```toml
{{#include ../book.toml:5:}}
```
</code></pre>
<pre><code class="language-toml">src = &quot;src&quot;
title = &quot;IRLab. Essential Notes&quot;

[output.html]
mathjax-support = true
additional-css = [&quot;theme/custom.css&quot;]

#[output.pdf]

[output.html.playground]
runnable = true
editable = true     # true にするとコードの編集が可能になる
copyable = true     # コピーボタンを表示
line-numbers = true # 行番号を表示
</code></pre>
<p><strong>指定した行まで</strong></p>
<pre><code class="language-toml">```toml
{{#include ../book.toml::5}}
```
</code></pre>
<pre><code class="language-toml">[book]
authors = [&quot;KazumichiINOUE&quot;]
language = &quot;jp&quot;
multilingual = false
src = &quot;src&quot;
</code></pre>
<p><a href="./"><i class="fa fa-arrow-left"></i> Home</a></p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="mdbookでのアンカーリンクの設定"><a class="header" href="#mdbookでのアンカーリンクの設定">mdBookでのアンカーリンクの設定</a></h1>
<p><strong>Create date:</strong> 2025-07-10<br />
<strong>Modified date:</strong> 2025-07-10</p>
<p>mdBookで見出しにアンカーリンクを設定する際，スペースや特殊文字が含まれる場合に問題が発生することがある．</p>
<h2 id="問題のあるケース"><a class="header" href="#問題のあるケース">問題のあるケース</a></h2>
<pre><code class="language-markdown">### Hint: モーターの回転制御プログラム {#hintmotor}
</code></pre>
<p>この記法では，<code>{#hintmotor}</code> 部分がそのまま表示されてしまう場合がある．</p>
<h2 id="確実に動作する方法"><a class="header" href="#確実に動作する方法">確実に動作する方法</a></h2>
<pre><code class="language-markdown">&lt;a id=&quot;hintmotor&quot;&gt;&lt;/a&gt;

### Hint: モーターの回転制御プログラム
</code></pre>
<p><strong>リンクの貼り方：</strong></p>
<pre><code class="language-markdown">[Hintプログラム](#hintmotor)
</code></pre>
<p><strong>メリット：</strong></p>
<ul>
<li>HTMLアンカータグは確実に動作する</li>
<li>見出しの表示に影響しない</li>
<li>mdBookのバージョンに依存しない</li>
</ul>
<h2 id="使用例"><a class="header" href="#使用例">使用例</a></h2>
<p><strong>マークダウンファイル内での記述：</strong></p>
<pre><code class="language-markdown">2. **テスト用プログラムの作成**
    - 下記の[Hintプログラム](#hintmotor)を参考に...

...

&lt;a id=&quot;hintmotor&quot;&gt;&lt;/a&gt;

### Hint: モーターの回転制御プログラム

前進パターンが分かったら，以下の雛形を使って...
</code></pre>
<p><strong>結果：</strong></p>
<ul>
<li>「Hintプログラム」がクリック可能なリンクになる</li>
<li>クリックすると該当する見出しにジャンプする</li>
<li>見出しは通常通り「Hint: モーターの回転制御プログラム」と表示される</li>
</ul>
<p><a href="./"><i class="fa fa-arrow-left"></i> Home</a></p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="mdbookでのcss開発tips"><a class="header" href="#mdbookでのcss開発tips">mdBookでのCSS開発Tips</a></h1>
<p><strong>Create date:</strong> 2025-07-10<br />
<strong>Modified date:</strong> 2025-07-10</p>
<p>mdBookでカスタムCSSを開発する際の実用的なTipsとトラブルシューティング．</p>
<h2 id="css反映の基本"><a class="header" href="#css反映の基本">CSS反映の基本</a></h2>
<h3 id="設定方法"><a class="header" href="#設定方法">設定方法</a></h3>
<ol>
<li><strong>CSSファイル作成</strong>: <code>theme/custom.css</code></li>
<li><strong>book.toml設定</strong>:
<pre><code class="language-toml">[output.html]
additional-css = [&quot;theme/custom.css&quot;]
</code></pre>
</li>
</ol>
<h3 id="ディレクトリ構造"><a class="header" href="#ディレクトリ構造">ディレクトリ構造</a></h3>
<pre><code>mybook/
├── book.toml
├── theme/
│   └── custom.css
└── src/
    └── (mdファイル)
</code></pre>
<h2 id="css反映時の注意点"><a class="header" href="#css反映時の注意点">CSS反映時の注意点</a></h2>
<h3 id="-mdbook-serve-の再起動が必要"><a class="header" href="#-mdbook-serve-の再起動が必要">🔄 mdbook serve の再起動が必要</a></h3>
<p><strong>症状</strong>: CSSを変更しても見た目が変わらない</p>
<p><strong>解決方法</strong>:</p>
<pre><code class="language-bash"># mdbook serve を一度停止（Ctrl+C）
# 再起動
mdbook serve
</code></pre>
<p><strong>理由</strong>: </p>
<ul>
<li>mdbook serve はCSSファイルの変更を自動検知しない場合がある</li>
<li>特に新しいCSSルールや大幅な変更時に発生</li>
</ul>
<h3 id="-ブラウザキャッシュ対策"><a class="header" href="#-ブラウザキャッシュ対策">🖥️ ブラウザキャッシュ対策</a></h3>
<p><strong>ハードリフレッシュ</strong>:</p>
<ul>
<li><strong>Mac</strong>: <code>Cmd + Shift + R</code></li>
<li><strong>Windows</strong>: <code>Ctrl + Shift + R</code></li>
</ul>
<h2 id="トラブルシューティング-1"><a class="header" href="#トラブルシューティング-1">トラブルシューティング</a></h2>
<h3 id="cssが反映されない場合のチェックリスト"><a class="header" href="#cssが反映されない場合のチェックリスト">CSSが反映されない場合のチェックリスト</a></h3>
<ol>
<li>
<p><strong>book.toml設定確認</strong></p>
<pre><code class="language-toml">[output.html]
additional-css = [&quot;theme/custom.css&quot;]  # パスが正しいか
</code></pre>
</li>
<li>
<p><strong>ファイル存在確認</strong></p>
<pre><code class="language-bash">ls theme/custom.css  # ファイルが存在するか
</code></pre>
</li>
<li>
<p><strong>mdbook serve の再起動</strong></p>
<pre><code class="language-bash"># Ctrl+C で停止
mdbook serve
</code></pre>
</li>
<li>
<p><strong>ブラウザハードリフレッシュ</strong></p>
<ul>
<li><code>Cmd + Shift + R</code> (Mac)</li>
<li><code>Ctrl + Shift + R</code> (Windows)</li>
</ul>
</li>
</ol>
<h3 id="よくある問題"><a class="header" href="#よくある問題">よくある問題</a></h3>
<h4 id="特定のスタイルが効かない"><a class="header" href="#特定のスタイルが効かない">特定のスタイルが効かない</a></h4>
<pre><code class="language-css">/* !important で強制適用 */
h2 {
    margin-top: 3rem !important;
}
</code></pre>
<h4 id="css読み込み順序の問題"><a class="header" href="#css読み込み順序の問題">CSS読み込み順序の問題</a></h4>
<pre><code class="language-toml"># 複数CSSファイルの場合は順序に注意
[output.html]
additional-css = [
    &quot;theme/base.css&quot;,    # 先に読み込まれる
    &quot;theme/custom.css&quot;   # 後に読み込まれる（優先される）
]
</code></pre>
<h4 id="キャッシュ対策"><a class="header" href="#キャッシュ対策">キャッシュ対策</a></h4>
<pre><code class="language-toml"># バージョン番号でキャッシュバスティング
[output.html]
additional-css = [&quot;theme/custom.css?v=2&quot;]
</code></pre>
<h2 id="開発効率化tips"><a class="header" href="#開発効率化tips">開発効率化Tips</a></h2>
<h3 id="css変更の確認手順"><a class="header" href="#css変更の確認手順">CSS変更の確認手順</a></h3>
<ol>
<li>CSSファイルを編集</li>
<li><code>mdbook serve</code> を再起動</li>
<li>ブラウザでハードリフレッシュ</li>
<li>開発者ツールで確認</li>
</ol>
<h3 id="デバッグ方法"><a class="header" href="#デバッグ方法">デバッグ方法</a></h3>
<pre><code class="language-css">/* 一時的な背景色でエリア確認 */
h2 {
    background-color: red !important; /* デバッグ用 */
}
</code></pre>
<pre><code class="language-css">/* 2025-07-09: H2見出しの上余白を増加 */
h2 {
    margin-top: 3rem; /* 2rem から変更 */
}
</code></pre>
<p><a href="./"><i class="fa fa-arrow-left"></i> Home</a></p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="画像の埋め込み"><a class="header" href="#画像の埋め込み">画像の埋め込み</a></h1>
<p><strong>Create date:</strong> 2025-07-05<br />
<strong>Modified date:</strong> 2025-07-05</p>
<p><img src="images/image.jpeg" alt="image" /></p>
<video controls style="width: 100%; height: auto;">
  <source src="images/movie.mp4" type="video/mp4">
  お使いのブラウザは動画に対応していません
</video>
<p><a href="./"><i class="fa fa-arrow-left"></i> Home</a></p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="mdbook内でrustコードの実行"><a class="header" href="#mdbook内でrustコードの実行">mdbook内でRustコードの実行</a></h1>
<p><strong>Create date:</strong> 2025-07-05<br />
<strong>Modified date:</strong> 2025-07-05</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">fn main() {
</span>  println!(&quot;Hello, World!&quot;);
<span class="boring">}
</span></code></pre></pre>
<pre><pre class="playground"><code class="language-rust editable">fn main() {
  println!(&quot;Hello, World!&quot;);
}
</code></pre></pre>
<blockquote>
<p><i class="fa fa-exclamation-circle"></i>
Note: Rust以外の言語は実行できません．</p>
<pre><code class="language-python">print(&quot;hello, mdbook&quot;)  # プレイボタンは表示されない
</code></pre>
</blockquote>
<p><a href="./"><i class="fa fa-arrow-left"></i> Home</a></p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="font-awesome-4-アイコン一覧表示つきコピペ用"><a class="header" href="#font-awesome-4-アイコン一覧表示つきコピペ用">Font Awesome 4 アイコン一覧（表示つき＋コピペ用）</a></h1>
<p><strong>Create date:</strong> 2025-07-05<br />
<strong>Modified date:</strong> 2025-07-05</p>
<p>よく使われる <code>Font Awesome 4</code> のシンプルアイコン一覧．</p>
<div class="table-wrapper"><table><thead><tr><th>表示</th><th>用途・意味</th><th>コピペ用コード</th></tr></thead><tbody>
<tr><td><i class="fa fa-bars"></i></td><td>メニュー・構造表示</td><td><code>&lt;i class=&quot;fa fa-bars&quot;&gt;&lt;/i&gt;</code></td></tr>
<tr><td><i class="fa fa-ellipsis-h"></i></td><td>オプション（横）</td><td><code>&lt;i class=&quot;fa fa-ellipsis-h&quot;&gt;&lt;/i&gt;</code></td></tr>
<tr><td><i class="fa fa-ellipsis-v"></i></td><td>オプション（縦）</td><td><code>&lt;i class=&quot;fa fa-ellipsis-v&quot;&gt;&lt;/i&gt;</code></td></tr>
<tr><td><i class="fa fa-list"></i></td><td>項目リスト</td><td><code>&lt;i class=&quot;fa fa-list&quot;&gt;&lt;/i&gt;</code></td></tr>
<tr><td><i class="fa fa-th-list"></i></td><td>表形式リスト</td><td><code>&lt;i class=&quot;fa fa-th-list&quot;&gt;&lt;/i&gt;</code></td></tr>
<tr><td><i class="fa fa-info-circle"></i></td><td>情報・補足</td><td><code>&lt;i class=&quot;fa fa-info-circle&quot;&gt;&lt;/i&gt;</code></td></tr>
<tr><td><i class="fa fa-lightbulb-o"></i></td><td>ヒント・ひらめき</td><td><code>&lt;i class=&quot;fa fa-lightbulb-o&quot;&gt;&lt;/i&gt;</code></td></tr>
<tr><td><i class="fa fa-question-circle"></i></td><td>ヘルプ・疑問</td><td><code>&lt;i class=&quot;fa fa-question-circle&quot;&gt;&lt;/i&gt;</code></td></tr>
<tr><td><i class="fa fa-exclamation-circle"></i></td><td>警告・注意</td><td><code>&lt;i class=&quot;fa fa-exclamation-circle&quot;&gt;&lt;/i&gt;</code></td></tr>
<tr><td><i class="fa fa-arrow-right"></i></td><td>次へ</td><td><code>&lt;i class=&quot;fa fa-arrow-right&quot;&gt;&lt;/i&gt;</code></td></tr>
<tr><td><i class="fa fa-arrow-left"></i></td><td>戻る</td><td><code>&lt;i class=&quot;fa fa-arrow-left&quot;&gt;&lt;/i&gt;</code></td></tr>
<tr><td><i class="fa fa-chevron-down"></i></td><td>開く・展開</td><td><code>&lt;i class=&quot;fa fa-chevron-down&quot;&gt;&lt;/i&gt;</code></td></tr>
<tr><td><i class="fa fa-chevron-up"></i></td><td>閉じる・折りたたむ</td><td><code>&lt;i class=&quot;fa fa-chevron-up&quot;&gt;&lt;/i&gt;</code></td></tr>
<tr><td><i class="fa fa-file-text-o"></i></td><td>文書・ファイル</td><td><code>&lt;i class=&quot;fa fa-file-text-o&quot;&gt;&lt;/i&gt;</code></td></tr>
<tr><td><i class="fa fa-link"></i></td><td>リンク</td><td><code>&lt;i class=&quot;fa fa-link&quot;&gt;&lt;/i&gt;</code></td></tr>
<tr><td><i class="fa fa-external-link"></i></td><td>外部リンク</td><td><code>&lt;i class=&quot;fa fa-external-link&quot;&gt;&lt;/i&gt;</code></td></tr>
<tr><td><i class="fa fa-paperclip"></i></td><td>添付資料</td><td><code>&lt;i class=&quot;fa fa-paperclip&quot;&gt;&lt;/i&gt;</code></td></tr>
<tr><td><i class="fa fa-check-circle"></i></td><td>成功・完了</td><td><code>&lt;i class=&quot;fa fa-check-circle&quot;&gt;&lt;/i&gt;</code></td></tr>
<tr><td><i class="fa fa-times-circle"></i></td><td>エラー・失敗</td><td><code>&lt;i class=&quot;fa fa-times-circle&quot;&gt;&lt;/i&gt;</code></td></tr>
<tr><td><i class="fa fa-spinner"></i></td><td>処理中・ロード中</td><td><code>&lt;i class=&quot;fa fa-spinner&quot;&gt;&lt;/i&gt;</code></td></tr>
<tr><td><i class="fa fa-refresh"></i></td><td>再読み込み</td><td><code>&lt;i class=&quot;fa fa-refresh&quot;&gt;&lt;/i&gt;</code></td></tr>
<tr><td><i class="fa fa-star"></i></td><td>おすすめ・注目</td><td><code>&lt;i class=&quot;fa fa-star&quot;&gt;&lt;/i&gt;</code></td></tr>
<tr><td><i class="fa fa-book"></i></td><td>資料・教科書</td><td><code>&lt;i class=&quot;fa fa-book&quot;&gt;&lt;/i&gt;</code></td></tr>
<tr><td><i class="fa fa-comments"></i></td><td>コメント・やりとり</td><td><code>&lt;i class=&quot;fa fa-comments&quot;&gt;&lt;/i&gt;</code></td></tr>
<tr><td><i class="fa fa-cog"></i></td><td>設定・オプション</td><td><code>&lt;i class=&quot;fa fa-cog&quot;&gt;&lt;/i&gt;</code></td></tr>
</tbody></table>
</div>
<p><a href="./"><i class="fa fa-arrow-left"></i> Home</a></p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->


                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">

            </nav>

        </div>



        <script type="text/javascript">
            window.playground_line_numbers = true;
        </script>

        <script type="text/javascript">
            window.playground_copyable = true;
        </script>

        <script src="ace.js" type="text/javascript" charset="utf-8"></script>
        <script src="editor.js" type="text/javascript" charset="utf-8"></script>
        <script src="mode-rust.js" type="text/javascript" charset="utf-8"></script>
        <script src="theme-dawn.js" type="text/javascript" charset="utf-8"></script>
        <script src="theme-tomorrow_night.js" type="text/javascript" charset="utf-8"></script>

        <script src="elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="searcher.js" type="text/javascript" charset="utf-8"></script>

        <script src="clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->

        <script type="text/javascript">
        window.addEventListener('load', function() {
            MathJax.Hub.Register.StartupHook('End', function() {
                window.setTimeout(window.print, 100);
            });
        });
        </script>

    </body>
</html>
